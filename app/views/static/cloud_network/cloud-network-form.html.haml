%form#form_div{'name'          => "angularForm",
               'form-changed'  => true,
               'miq-form'      => true,
               'model'         => "vm.cloudNetworkModel",
               'model-copy'    => "vm.modelCopy",
               'ng-cloak'      => "",
               'ng-show'       => "vm.afterGet"}
  %h3
    = _('Network Provider')
  .form-horizontal
    .form-group
      %label.col-md-2.control-label
        = _('Network Manager')
      .col-md-8{'ng-class' => "{'has-error': angularForm.ems_id.$invalid}", 'ng-if' => "vm.newRecord"}
        %select{'id'                          => 'ems_id',
                'name'                        => 'ems_id',
                'ng-change'                   => "vm.filterNetworkManagerChanged(vm.cloudNetworkModel.ems_id)",
                'ng-model'                    => "vm.cloudNetworkModel.ems_id",
                'ng-options'                  => 'ems.id as ems.name for ems in vm.ems',
                'miq-select'                  => true,
                'required'                    => ""}
          %option{'value' => "",'disabled'=> ""}
            = "<#{_('Choose')}>"
        %span.help-block{"ng-show" => "angularForm.ems_id.$error.required"}
          = _("Required")
      .col-md-8{'ng-if' => "!vm.newRecord"}
        %input.form-control{'type'         => "text",
                            'name'         => "ems_name",
                            'maxlength'    => 128,
                            'ng-model'     => "vm.cloudNetworkModel.ext_management_system.name",
                            'ng-disabled'  => true}
    %h3
  .form-horizontal{'ng-if' => "vm.cloudNetworkModel.ems_id && (vm.cloudNetworkModel.emstype || vm.cloudNetworkModel.ext_management_system.type)!='ManageIQ::Providers::Alibaba::NetworkManager'",}
    %h3
      = _('Placement')
    .form-group
      %label.col-md-2.control-label
        = _('Cloud Tenant')
      .col-md-8{'ng-class' => "{'has-error': angularForm.cloud_tenant_id.$invalid}", 'ng-if' => "vm.newRecord"}
        %select{'name'                        => "cloud_tenant_id",
                'ng-model'                    => "vm.cloudNetworkModel.cloud_tenant.id",
                'ng-options'                  => "tenant.id as tenant.name for tenant in vm.available_tenants",
                'miq-select'                  => true,
                'required'                    => "",
                'selectpicker-for-select-tag' => ""}
          %option{'value' => "",'disabled'=> ""}
            = "<#{_('Choose')}>"
        %span.help-block{'ng-show' => "angularForm.cloud_tenant_id.$error.required"}
          = _("Required")
      .col-md-8{'ng-if' => "!vm.newRecord "}
        %input.form-control{'type'         => "text",
                            'name'         => "cloud_tenant_name",
                            'maxlength'    => 128,
                            'ng-model'     => "vm.cloudNetworkModel.cloud_tenant.name",
                            'ng-disabled'  => true}
  .form-horizontal{'ng-if' => "vm.cloudNetworkModel.cloud_tenant.id && (vm.cloudNetworkModel.emstype != 'ManageIQ::Providers::Alibaba::NetworkManager')"}
    %h3
      = _('Network Provider Information')
    .form-group
      %label.col-md-2.control-label
        = _('Provider Network Type')
      .col-md-8
        %select{'name'                        => "provider_network_type",
                'ng-disabled'                 => "!vm.newRecord",
                'ng-model'                    => "vm.cloudNetworkModel.provider_network_type",
                'ng-options'                  => "type as key for (key, type) in vm.providers_network_types",
                "miq-select"                  => true,
                "selectpicker-for-select-tag" => ""}
          %option{'value' => "",'disabled'=> ""}
            = "<#{_('Choose')}>"
    .form-group{'ng-if'    => "vm.network_types_for_physical_network.test(vm.cloudNetworkModel.provider_network_type)",
                'ng-class' => "{'has-error': angularForm.provider_physical_network.$invalid}"}
      %label.control-label.col-md-2
        = _('Physical Network')
      .col-md-8
        %input.form-control{'type'         => "text",
                            'name'         => "provider_physical_network",
                            'ng-disabled'  => "!vm.newRecord",
                            'ng-model'     => "vm.cloudNetworkModel.provider_physical_network",
                            'ng-required'  => "vm.is_physical_network_required.test(vm.cloudNetworkModel.provider_network_type)",
                            'maxlength'    => 128}
        %span.help-block{"ng-show" => "angularForm.provider_physical_network.$error.required"}
          = _("Required")
    .form-group{'ng-if'    => "vm.network_types_for_segmentation.test(vm.cloudNetworkModel.provider_network_type)",
                'ng-class' => "{'has-error': angularForm.provider_segmentation_id.$invalid}"}
      %label.control-label.col-md-2
        = _('Segmentation ID')
      .col-md-8
        %input.form-control{'type'         => "text",
                            'name'         => "provider_segmentation_id",
                            'ng-disabled'  => "!vm.newRecord",
                            'ng-model'     => "vm.cloudNetworkModel.provider_segmentation_id",
                            'ng-required'  => "vm.is_subscription_id_required.test(vm.cloudNetworkModel.provider_network_type)",
                            'maxlength'    => 128}
        %span.help-block{"ng-show" => "angularForm.provider_segmentation_id.$error.required"}
          = _("Required")
  %h3
    = _('Network Information')
  .form-horizontal
    .form-group{'ng-class' => "{'has-error': angularForm.ems_ref.$invalid}",
                'ng-if'=> "!vm.newRecord"}
      %label.col-md-2.control-label
        = _('Network Id')
      .col-md-8
        %input.form-control{'type'         => "text",
                            'name'         => "ems_ref",
                            'ng-disabled'  => true,
                            'ng-model'     => "vm.cloudNetworkModel.ems_ref",
                            'maxlength'    => 128,
                            }
        %span.help-block{"ng-show" => "angularForm.ems_ref.$error.required"}
          = _("Required")
    .form-group{'ng-class' => "{'has-error': angularForm.name.$invalid}"}
      %label.col-md-2.control-label
        = _('Network Name')
      .col-md-8
        %input.form-control{'type'         => "text",
                            'name'         => "name",
                            'ng-model'     => "vm.cloudNetworkModel.name",
                            'maxlength'    => 128,
                            'required'     => ""}
        %span.help-block{"ng-show" => "angularForm.name.$error.required"}
          = _("Required")
    .form-group{'ng-class' => "{'has-error': angularForm.cidr.$invalid}",
                'ng-if' => "vm.cloudNetworkModel.ems_id && (vm.cloudNetworkModel.emstype || vm.cloudNetworkModel.ext_management_system.type)=='ManageIQ::Providers::Alibaba::NetworkManager'" }
      %label.col-md-2.control-label
        = _('CIDR Block')
      .col-md-8{'ng-class' => "{'has-error': angularForm.cidr.$invalid}", 'ng-if' => "vm.newRecord"}
        %select{'name'                        => "cidr",
                'ng-model'                    => "vm.cloudNetworkModel.cidr",
                'ng-options'                  => "type as key for (key, type) in vm.cidrBlock",
                'miq-select'                  => true,
                'required'                    => "",
                'selectpicker-for-select-tag' => ""}
          %option{'value' => "",'disabled'=> ""}
            = "<#{_('Choose')}>"
        %span.help-block{'ng-show' => 'angularForm.cidr.$error.required'}
          = _('Required')
      .col-md-8{'ng-if' => "!vm.newRecord"}
        %input.form-control{'type'         => "text",
                            'name'         => "cidr",
                            'maxlength'    => 20,
                            'ng-model'     => "vm.cloudNetworkModel.cidr",
                            'ng-disabled'  => true}
    .form-group{'ng-if' => "vm.cloudNetworkModel.emstype =='ManageIQ::Providers::Alibaba::NetworkManager' && vm.custom_cidr.test(vm.cloudNetworkModel.cidr)",
                'ng-class' => "{'has-error': angularForm.customcidr.$invalid}"}
      %label.control-label.col-md-2
        = _('Custom CIDR')
      .col-md-8
        %input.form-control{'type'         => "text",
                            'id'           => "customcidr_id",
                            'name'         => "customcidr",
                            'ng-pattern'   => "/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/([89]|1[0-9]|2[0-4]))+$/",
                            'ng-disabled'  => "!vm.newRecord",
                            'ng-model'     => "vm.cloudNetworkModel.customcidr",
                            'ng-required'  => "vm.is_custom_cidr_required.test(vm.cloudNetworkModel.cidr)",
                            'require'      => "",
                            'maxlength'    => 20,}
        %span.help-block{'ng-show' => 'angularForm.customcidr.$error.required'}
          = _('Required')
  .form-horizontal{'ng-if' => "(vm.cloudNetworkModel.emstype || vm.cloudNetworkModel.ext_management_system.type)!='ManageIQ::Providers::Alibaba::NetworkManager'",}
    %h3
    .form-group
      %label.control-label.col-md-2{"for" => "cloud_network_external_facing"}
        = _('External Router')
      .col-md-8
        %input{'bs-switch'   => "",
               'data'        => {:on_text => _('Yes'), :off_text => _('No'), :size => 'mini'},
               'type'        => "checkbox",
               'id'          => "cloud_network_external_facing",
               'name'        => "external_facing",
               'ng-model'    => "vm.cloudNetworkModel.external_facing"}
    .form-group
      %label.control-label.col-md-2{"for" => "cloud_network_enabled"}
        = _('Administrative State')
      .col-md-8
        %input{'bs-switch'   => "",
               'data'        => {:on_text => _('Up'), :off_text => _('Down'), :size => 'mini'},
               'type'        => "checkbox",
               'id'          => "cloud_network_enabled",
               'name'        => "enabled",
               'ng-model'    => "vm.cloudNetworkModel.enabled"}
    .form-group
      %label.control-label.col-md-2
        = _('Shared')
      .col-md-8
        %input{'bs-switch'   => "",
               'data'        => {:on_text => _('Yes'), :off_text => _('No'), :size => 'mini'},
               'type'        => "checkbox",
               'id'          => "cloud_network_shared",
               'name'        => "shared",
               'ng-model'    => "vm.cloudNetworkModel.shared"}
  = render :partial => "layouts/angular/generic_form_buttons"
